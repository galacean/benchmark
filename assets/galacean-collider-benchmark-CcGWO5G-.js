import"./modulepreload-polyfill-B5Qt9EMX.js";import{V as h,Q as y,W as U,C as Q,D as q,S as Y,P as G,M as k,b as V,c as K,d as j,B as Z,e as $}from"./module-BxLNiwNf.js";function A(o,s){return s!=null&&typeof Symbol<"u"&&s[Symbol.hasInstance]?!!s[Symbol.hasInstance](o):o instanceof s}function w(o,s){return w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},w(o,s)}function m(o,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(s&&s.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),s&&w(o,s)}var W=function(){function o(n){n===void 0&&(n=0),this.length=0,this._elements=new Array(n)}var s=o.prototype;return s.add=function(t){this.length===this._elements.length?this._elements.push(t):this._elements[this.length]=t,this.length++},s.delete=function(t){var e=this._elements.indexOf(t);this.deleteByIndex(e)},s.get=function(t){if(t>=this.length)throw"Index is out of range.";return this._elements[t]},s.deleteByIndex=function(t){var e=this._elements,i=null,r=this.length-1;return t!==r&&(i=e[r],e[t]=i),this.length--,i},s.garbageCollection=function(){this._elements.length=this.length},o}(),X;(function(o){o[o.SIMULATION_SHAPE=1]="SIMULATION_SHAPE",o[o.SCENE_QUERY_SHAPE=2]="SCENE_QUERY_SHAPE",o[o.TRIGGER_SHAPE=4]="TRIGGER_SHAPE"})(X||(X={}));var x=function(){function o(n){this._controllers=new W,this._worldScale=new h(1,1,1),this._position=new h,this._rotation=null,this._axis=null,this._physXRotation=new y,this._shapeFlags=3,this._physXPhysics=n}var s=o.prototype;return s.setRotation=function(t){this._rotation=t,y.rotationYawPitchRoll(t.x,t.y,t.z,this._physXRotation),this._axis&&y.multiply(this._physXRotation,this._axis,this._physXRotation),this._physXRotation.normalize(),this._setLocalPose()},s.setPosition=function(t){t!==this._position&&this._position.copyFrom(t);for(var e=this._controllers,i=0,r=e.length;i<r;i++)e.get(i)._updateShapePosition(this._position,this._worldScale);this._setLocalPose()},s.setWorldScale=function(t){this._worldScale.copyFrom(t),this._setLocalPose();for(var e=this._controllers,i=0,r=e.length;i<r;i++)e.get(i)._updateShapePosition(this._position,this._worldScale)},s.setContactOffset=function(t){this._pxShape.setContactOffset(t);for(var e=this._controllers,i=0,r=e.length;i<r;i++)e.get(i)._pxController.setContactOffset(t)},s.setMaterial=function(t){this._pxMaterial=t._pxMaterial,this._pxShape.setMaterial(this._pxMaterial)},s.setIsTrigger=function(t){this._modifyFlag(1,!t),this._modifyFlag(4,t),this._setShapeFlags(this._shapeFlags)},s.destroy=function(){this._pxShape.release()},s._setShapeFlags=function(t){this._shapeFlags=t,this._pxShape.setFlags(new this._physXPhysics._physX.PxShapeFlags(this._shapeFlags))},s._setLocalPose=function(){var t=o.transform;h.multiply(this._position,this._worldScale,t.translation),t.rotation=this._physXRotation,this._pxShape.setLocalPose(t)},s._initialize=function(t,e){this._id=e,this._pxMaterial=t._pxMaterial,this._pxShape=this._physXPhysics._pxPhysics.createShape(this._pxGeometry,t._pxMaterial,!0,new this._physXPhysics._physX.PxShapeFlags(this._shapeFlags)),this._pxShape.setUUID(e)},s._modifyFlag=function(t,e){this._shapeFlags=e?this._shapeFlags|t:this._shapeFlags&~t},o}();(function(){x.halfSqrt=.70710678118655})();(function(){x.transform={translation:new h,rotation:null}})();var b=function(o){m(s,o);function s(t,e,i,r){var a;a=o.call(this,t)||this,a._halfSize=new h,a._sizeScale=new h(1,1,1);var l=a._halfSize;return l.set(i.x*.5,i.y*.5,i.z*.5),a._pxGeometry=new t._physX.PxBoxGeometry(l.x,l.y,l.z),a._initialize(r,e),a._setLocalPose(),a}var n=s.prototype;return n.setSize=function(e){var i=this._halfSize,r=s._tempHalfExtents;i.set(e.x*.5,e.y*.5,e.z*.5),h.multiply(i,this._sizeScale,r),this._pxGeometry.halfExtents=r,this._pxShape.setGeometry(this._pxGeometry),this._updateController(r)},n.setWorldScale=function(e){o.prototype.setWorldScale.call(this,e),this._sizeScale.set(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z));var i=s._tempHalfExtents;h.multiply(this._halfSize,this._sizeScale,i),this._pxGeometry.halfExtents=i,this._pxShape.setGeometry(this._pxGeometry),this._updateController(i)},n._updateController=function(e){for(var i=this._controllers,r=0,a=i.length;r<a;r++){var l=i.get(r)._pxController;l.setHalfHeight(e.x),l.setHalfSideExtent(e.y),l.setHalfForwardExtent(e.z)}},s}(x);(function(){b._tempHalfExtents=new h})();var N=function(o){m(s,o);function s(t,e,i,r,a){var l;return l=o.call(this,t)||this,l._upAxis=1,l._sizeScale=new h(1,1,1),l._radius=i,l._halfHeight=r*.5,l._axis=new y(0,0,x.halfSqrt,x.halfSqrt),l._physXRotation.copyFrom(l._axis),l._pxGeometry=new t._physX.PxCapsuleGeometry(l._radius,l._halfHeight),l._initialize(a,e),l._setLocalPose(),l}var n=s.prototype;return n.setRadius=function(e){this._radius=e;var i=this._sizeScale;switch(this._upAxis){case 0:this._pxGeometry.radius=this._radius*Math.max(i.y,i.z);break;case 1:this._pxGeometry.radius=this._radius*Math.max(i.x,i.z);break;case 2:this._pxGeometry.radius=this._radius*Math.max(i.x,i.y);break}this._pxShape.setGeometry(this._pxGeometry);for(var r=this._pxGeometry.radius,a=this._controllers,l=0,_=a.length;l<_;l++)a.get(l)._pxController.setRadius(r)},n.setHeight=function(e){this._halfHeight=e*.5;var i=this._sizeScale;switch(this._upAxis){case 0:this._pxGeometry.halfHeight=this._halfHeight*i.x;break;case 1:this._pxGeometry.halfHeight=this._halfHeight*i.y;break;case 2:this._pxGeometry.halfHeight=this._halfHeight*i.z;break}this._pxShape.setGeometry(this._pxGeometry);for(var r=this._pxGeometry.halfHeight*2,a=this._controllers,l=0,_=a.length;l<_;l++)a.get(l)._pxController.setHeight(r)},n.setUpAxis=function(e){var i=this,r=i._rotation,a=i._axis,l=i._physXRotation;switch(this._upAxis=e,this._upAxis){case 0:a.set(0,0,0,1);break;case 1:a.set(0,0,x.halfSqrt,x.halfSqrt);break;case 2:a.set(0,x.halfSqrt,0,x.halfSqrt);break}r?(y.rotationYawPitchRoll(r.x,r.y,r.z,l),y.multiply(l,a,l)):l.copyFrom(a),this._setLocalPose()},n.setWorldScale=function(e){o.prototype.setWorldScale.call(this,e);var i=this._sizeScale.set(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),r=this._pxGeometry;switch(this._upAxis){case 0:r.radius=this._radius*Math.max(i.y,i.z),r.halfHeight=this._halfHeight*i.x;break;case 1:r.radius=this._radius*Math.max(i.x,i.z),r.halfHeight=this._halfHeight*i.y;break;case 2:r.radius=this._radius*Math.max(i.x,i.y),r.halfHeight=this._halfHeight*i.z;break}this._pxShape.setGeometry(r);for(var a=r.radius,l=r.halfHeight*2,_=this._controllers,c=0,u=_.length;c<u;c++){var g=_.get(c)._pxController;g.setRadius(a),g.setHeight(l)}},s}(x),I;(function(o){o[o.X=0]="X",o[o.Y=1]="Y",o[o.Z=2]="Z"})(I||(I={}));var O=function(){function o(n){this._shapeScaledPosition=new h,this._worldPosition=null,this._physXPhysics=n}var s=o.prototype;return s.move=function(t,e,i){var r,a;return(a=(r=this._pxController)==null?void 0:r.move(t,e,i))!=null?a:0},s.setWorldPosition=function(t){this._worldPosition=t,this._updateNativePosition()},s.getWorldPosition=function(t){this._pxController&&(t.copyFrom(this._pxController.getPosition()),t.subtract(this._shapeScaledPosition))},s.setStepOffset=function(t){var e;(e=this._pxController)==null||e.setStepOffset(t)},s.setNonWalkableMode=function(t){var e;(e=this._pxController)==null||e.setNonWalkableMode(t)},s.setUpDirection=function(t){var e;(e=this._pxController)==null||e.setUpDirection(t)},s.setSlopeLimit=function(t){var e;(e=this._pxController)==null||e.setSlopeLimit(t)},s.addShape=function(t){this._pxManager&&this._createPXController(this._pxManager,t),this._shape=t,t._controllers.add(this)},s.removeShape=function(t){this._destroyPXController(),this._shape=null,t._controllers.delete(this)},s.destroy=function(){this._destroyPXController()},s._createPXController=function(t,e){var i;if(A(e,b))i=new this._physXPhysics._physX.PxBoxControllerDesc,i.halfHeight=e._halfSize.x,i.halfSideExtent=e._halfSize.y,i.halfForwardExtent=e._halfSize.z;else if(A(e,N))i=new this._physXPhysics._physX.PxCapsuleControllerDesc,i.radius=e._radius,i.height=e._halfHeight*2,i.climbingMode=1;else throw"unsupported shape type";i.setMaterial(e._pxMaterial),this._pxController=t._getControllerManager().createController(i),this._pxController.setUUID(e._id)},s._destroyPXController=function(){this._pxController&&(this._pxController.release(),this._pxController=null)},s._updateShapePosition=function(t,e){h.multiply(t,e,this._shapeScaledPosition),this._updateNativePosition()},s._updateNativePosition=function(){var t=this._worldPosition;this._pxController&&t&&(h.add(t,this._shapeScaledPosition,o._tempVec),this._pxController.setPosition(o._tempVec))},o}();(function(){O._tempVec=new h})();var F=function(){function o(n){this._physXPhysics=n}var s=o.prototype;return s.addShape=function(t){this._pxActor.attachShape(t._pxShape)},s.removeShape=function(t){this._pxActor.detachShape(t._pxShape,!0)},s.setWorldTransform=function(t,e){this._pxActor.setGlobalPose(this._transform(t,e),!0)},s.getWorldTransform=function(t,e){var i=this._pxActor.getGlobalPose();t.set(i.translation.x,i.translation.y,i.translation.z),e.set(i.rotation.x,i.rotation.y,i.rotation.z,i.rotation.w)},s.destroy=function(){this._pxActor.release()},s._transform=function(t,e){var i=o._tempTransform;return i.translation=t,i.rotation=e.normalize(),i},o}();(function(){F._tempTransform={translation:null,rotation:null}})();var z;(function(o){o[o.Discrete=0]="Discrete",o[o.Continuous=1]="Continuous",o[o.ContinuousDynamic=2]="ContinuousDynamic",o[o.ContinuousSpeculative=3]="ContinuousSpeculative"})(z||(z={}));var E=function(o){m(s,o);function s(t,e,i){var r;r=o.call(this,t)||this;var a=r._transform(e,i);return r._pxActor=t._pxPhysics.createRigidDynamic(a),r}var n=s.prototype;return n.setLinearDamping=function(e){this._pxActor.setLinearDamping(e)},n.setAngularDamping=function(e){this._pxActor.setAngularDamping(e)},n.setLinearVelocity=function(e){this._pxActor.setLinearVelocity(e,!0)},n.setAngularVelocity=function(e){this._pxActor.setAngularVelocity(e,!0)},n.setMass=function(e){this._pxActor.setMass(e)},n.setCenterOfMass=function(e){this._pxActor.setCMassLocalPose(e)},n.setInertiaTensor=function(e){this._pxActor.setMassSpaceInertiaTensor(e)},n.setMaxAngularVelocity=function(e){this._pxActor.setMaxAngularVelocity(e)},n.setMaxDepenetrationVelocity=function(e){this._pxActor.setMaxDepenetrationVelocity(e)},n.setSleepThreshold=function(e){this._pxActor.setSleepThreshold(e)},n.setSolverIterations=function(e){this._pxActor.setSolverIterationCounts(e,1)},n.setCollisionDetectionMode=function(e){switch(e){case 1:this._pxActor.setRigidBodyFlag(this._physXPhysics._physX.PxRigidBodyFlag.eENABLE_CCD,!0);break;case 2:this._pxActor.setRigidBodyFlag(this._physXPhysics._physX.PxRigidBodyFlag.eENABLE_CCD_FRICTION,!0);break;case 3:this._pxActor.setRigidBodyFlag(this._physXPhysics._physX.PxRigidBodyFlag.eENABLE_SPECULATIVE_CCD,!0);break;case 0:var i=this._physXPhysics._physX;this._pxActor.setRigidBodyFlag(i.PxRigidBodyFlag.eENABLE_CCD,!1),this._pxActor.setRigidBodyFlag(i.PxRigidBodyFlag.eENABLE_CCD_FRICTION,!1),this._pxActor.setRigidBodyFlag(i.PxRigidBodyFlag.eENABLE_SPECULATIVE_CCD,!1);break}},n.setIsKinematic=function(e){e?this._pxActor.setRigidBodyFlag(this._physXPhysics._physX.PxRigidBodyFlag.eKINEMATIC,!0):this._pxActor.setRigidBodyFlag(this._physXPhysics._physX.PxRigidBodyFlag.eKINEMATIC,!1)},n.setConstraints=function(e){this._pxActor.setRigidDynamicLockFlags(e)},n.addForce=function(e){this._pxActor.addForce({x:e.x,y:e.y,z:e.z})},n.addTorque=function(e){this._pxActor.addTorque({x:e.x,y:e.y,z:e.z})},n.move=function(e,i){if(i){this._pxActor.setKinematicTarget(e,i);return}var r=s._tempTranslation,a=s._tempRotation;this.getWorldTransform(r,a),A(e,h)?this._pxActor.setKinematicTarget(e,a):this._pxActor.setKinematicTarget(r,e)},n.sleep=function(){return this._pxActor.putToSleep()},n.wakeUp=function(){return this._pxActor.wakeUp()},s}(F);(function(){E._tempTranslation=new h})();(function(){E._tempRotation=new y})();var tt=function(){this._eventMap={}},et=function(){function o(n,t,e,i,r,a){this._physXPhysics=n;var l=n._pxPhysics.createMaterial(t,e,i);l.setFrictionCombineMode(r),l.setRestitutionCombineMode(a),this._pxMaterial=l}var s=o.prototype;return s.setBounciness=function(t){this._pxMaterial.setRestitution(t)},s.setDynamicFriction=function(t){this._pxMaterial.setDynamicFriction(t)},s.setStaticFriction=function(t){this._pxMaterial.setStaticFriction(t)},s.setBounceCombine=function(t){this._pxMaterial.setRestitutionCombineMode(t)},s.setFrictionCombine=function(t){this._pxMaterial.setFrictionCombineMode(t)},s.destroy=function(){this._pxMaterial.release()},o}(),L;(function(o){o[o.Average=0]="Average",o[o.Minimum=1]="Minimum",o[o.Multiply=2]="Multiply",o[o.Maximum=3]="Maximum"})(L||(L={}));var R=function(){function o(n,t,e,i,r,a,l,_){var c=this;this._pxControllerManager=null,this._currentEvents=new W,this._eventPool=[],this._physXPhysics=n,this._physXManager=t;var u=n._physX;this._pxRaycastHit=new u.PxRaycastHit,this._pxFilterData=new u.PxQueryFilterData,this._pxFilterData.flags=new u.PxQueryFlags(7),this._onContactEnter=e,this._onContactExit=i,this._onContactStay=r,this._onTriggerEnter=a,this._onTriggerExit=l,this._onTriggerStay=_;var g={onContactBegin:function(f,d){c._onContactEnter(f,d)},onContactEnd:function(f,d){c._onContactExit(f,d)},onContactPersist:function(f,d){c._onContactStay(f,d)},onTriggerBegin:function(f,d){var P=f<d?c._getTrigger(f,d):c._getTrigger(d,f);P.state=0,c._currentEvents.add(P)},onTriggerEnd:function(f,d){var P;if(f<d){var D=c._physXManager._eventMap[f];P=D[d],D[d]=void 0}else{var T=c._physXManager._eventMap[d];P=T[f],T[f]=void 0}P.state=2}},S=n._pxPhysics,C=u.PxSimulationEventCallback.implement(g),M=u.getDefaultSceneDesc(S.getTolerancesScale(),0,C);this._pxScene=S.createScene(M)}var s=o.prototype;return s.setGravity=function(t){this._pxScene.setGravity(t)},s.addColliderShape=function(t){this._physXManager._eventMap[t._id]={}},s.removeColliderShape=function(t){for(var e=this,i=e._eventPool,r=e._currentEvents,a=t._id,l=this._physXManager,_=l._eventMap,c=r.length-1;c>=0;c--){var u=r.get(c);u.index1==a?(r.deleteByIndex(c),i.push(u)):u.index2==a&&(r.deleteByIndex(c),i.push(u),_[u.index1][a]=void 0)}delete _[a]},s.addCollider=function(t){this._pxScene.addActor(t._pxActor,null)},s.removeCollider=function(t){this._pxScene.removeActor(t._pxActor,!0)},s.addCharacterController=function(t){if(!t._pxController){var e=t._shape;if(e){var i=t._pxManager;i!==this&&(i&&t._destroyPXController(),t._createPXController(this,e))}}t._pxManager=this},s.removeCharacterController=function(t){t._pxManager=null},s.update=function(t){this._simulate(t),this._fetchResults(),this._fireEvent()},s.raycast=function(t,e,i,r){var a=this,l=a._pxRaycastHit;e=Math.min(e,34e37);var _={preFilter:function(M,f,d){return i(f)?2:0},postFilter:function(M,f){}},c=this._pxScene.raycastSingle(t.origin,t.direction,e,l,this._pxFilterData,this._physXPhysics._physX.PxQueryFilterCallback.implement(_));if(c&&r!=null){var u=o._tempPosition,g=o._tempNormal,S=l.position,C=l.normal;u.set(S.x,S.y,S.z),g.set(C.x,C.y,C.z),r(l.getShape().getUUID(),l.distance,u,g)}return c},s._getControllerManager=function(){var t=this._pxControllerManager;return t===null&&(this._pxControllerManager=t=this._pxScene.createControllerManager()),t},s._simulate=function(t){this._pxScene.simulate(t,!0)},s._fetchResults=function(t){t===void 0&&(t=!0),this._pxScene.fetchResults(t)},s._getTrigger=function(t,e){var i;return this._eventPool.length?(i=this._eventPool.pop(),i.index1=t,i.index2=e):i=new it(t,e),this._physXManager._eventMap[t][e]=i,i},s._fireEvent=function(){for(var t=this,e=t._eventPool,i=t._currentEvents,r=i.length-1;r>=0;r--){var a=i.get(r);a.state==0?(this._onTriggerEnter(a.index1,a.index2),a.state=1):a.state==1?this._onTriggerStay(a.index1,a.index2):a.state==2&&(this._onTriggerExit(a.index1,a.index2),i.deleteByIndex(r),e.push(a))}},o}();(function(){R._tempPosition=new h})();(function(){R._tempNormal=new h})();var B;(function(o){o[o.STATIC=1]="STATIC",o[o.DYNAMIC=2]="DYNAMIC",o[o.PRE_FILTER=4]="PRE_FILTER",o[o.POST_FILTER=8]="POST_FILTER",o[o.ANY_HIT=16]="ANY_HIT",o[o.NO_BLOCK=32]="NO_BLOCK"})(B||(B={}));var H;(function(o){o[o.Enter=0]="Enter",o[o.Stay=1]="Stay",o[o.Exit=2]="Exit"})(H||(H={}));var it=function(s,n){this.index1=s,this.index2=n},nt=function(o){m(s,o);function s(n,t,e){var i;return i=o.call(this,n)||this,i._pxActor=n._pxPhysics.createRigidStatic(i._transform(t,e)),i}return s}(F),v;(function(o){o[o.Auto=0]="Auto",o[o.WebAssembly=1]="WebAssembly",o[o.JavaScript=2]="JavaScript"})(v||(v={}));var p=function(){function o(n){this._connectedAnchor=new h,this._breakForce=Number.MAX_VALUE,this._breakTorque=Number.MAX_VALUE,this._physXPhysics=n}var s=o.prototype;return s.setConnectedCollider=function(t){var e,i;this._pxJoint.setActors(((e=t)==null?void 0:e._pxActor)||null,((i=this._collider)==null?void 0:i._pxActor)||null)},s.setConnectedAnchor=function(t){this._connectedAnchor.copyFrom(t),this._setLocalPose(0,t,o._defaultQuat)},s.setConnectedMassScale=function(t){this._pxJoint.setInvMassScale0(1/t)},s.setConnectedInertiaScale=function(t){this._pxJoint.setInvInertiaScale0(1/t)},s.setMassScale=function(t){this._pxJoint.setInvMassScale1(1/t)},s.setInertiaScale=function(t){this._pxJoint.setInvInertiaScale1(1/t)},s.setBreakForce=function(t){this._breakForce=t,this._pxJoint.setBreakForce(this._breakForce,this._breakTorque)},s.setBreakTorque=function(t){this._breakTorque=t,this._pxJoint.setBreakForce(this._breakForce,this._breakTorque)},s._setLocalPose=function(t,e,i){this._pxJoint.setLocalPose(t,e,i)},o}();(function(){p._xAxis=new h(1,0,0)})();(function(){p._defaultVec=new h})();(function(){p._defaultQuat=new y})();var st=function(o){m(s,o);function s(n,t){var e;return e=o.call(this,n)||this,e._collider=t,e._pxJoint=n._pxPhysics.createFixedJoint(null,p._defaultVec,p._defaultQuat,t._pxActor,p._defaultVec,p._defaultQuat),e}return s}(p),ot=function(o){m(s,o);function s(t,e){var i;return i=o.call(this,t)||this,i._axisRotationQuaternion=new y,i._swingOffset=new h,i._collider=e,i._pxJoint=t._pxPhysics.createRevoluteJoint(null,p._defaultVec,p._defaultQuat,e._pxActor,p._defaultVec,p._defaultQuat),i}var n=s.prototype;return n.setAxis=function(e){var i=p._xAxis,r=this._axisRotationQuaternion;i.set(1,0,0),e.normalize();var a=Math.acos(h.dot(i,e));h.cross(i,e,i),y.rotationAxisAngle(i,a,r),this._setLocalPose(0,this._swingOffset,r)},n.setSwingOffset=function(e){this._swingOffset.copyFrom(e),this._setLocalPose(1,this._swingOffset,this._axisRotationQuaternion)},n.getAngle=function(){return this._pxJoint.getAngle()},n.getVelocity=function(){return this._pxJoint.getVelocity()},n.setHardLimit=function(e,i,r){this._pxJoint.setHardLimit(e,i,r)},n.setSoftLimit=function(e,i,r,a){this._pxJoint.setSoftLimit(e,i,r,a)},n.setDriveVelocity=function(e,i){i===void 0&&(i=!0),this._pxJoint.setDriveVelocity(e,i)},n.setDriveForceLimit=function(e){this._pxJoint.setDriveForceLimit(e)},n.setDriveGearRatio=function(e){this._pxJoint.setDriveGearRatio(e)},n.setHingeJointFlag=function(e,i){this._pxJoint.setRevoluteJointFlag(e,i)},s}(p),rt=function(o){m(s,o);function s(t,e){var i;return i=o.call(this,t)||this,i._swingOffset=new h,i._collider=e,i._pxJoint=t._pxPhysics.createDistanceJoint(null,p._defaultVec,p._defaultQuat,e._pxActor,p._defaultVec,p._defaultQuat),i._pxJoint.setDistanceJointFlag(2,!0),i._pxJoint.setDistanceJointFlag(4,!0),i._pxJoint.setDistanceJointFlag(8,!0),i}var n=s.prototype;return n.setSwingOffset=function(e){this._swingOffset.copyFrom(e),this._setLocalPose(1,e,p._defaultQuat)},n.setMinDistance=function(e){this._pxJoint.setMinDistance(e)},n.setMaxDistance=function(e){this._pxJoint.setMaxDistance(e)},n.setTolerance=function(e){this._pxJoint.setTolerance(e)},n.setStiffness=function(e){this._pxJoint.setStiffness(e)},n.setDamping=function(e){this._pxJoint.setDamping(e)},s}(p),at=function(o){m(s,o);function s(n,t,e){var i;return i=o.call(this,n)||this,i._axis=new y(0,0,x.halfSqrt,x.halfSqrt),i._physXRotation.copyFrom(i._axis),i._pxGeometry=new n._physX.PxPlaneGeometry,i._initialize(e,t),i._setLocalPose(),i}return s}(x),lt=function(o){m(s,o);function s(t,e,i,r){var a;return a=o.call(this,t)||this,a._maxScale=1,a._radius=i,a._pxGeometry=new t._physX.PxSphereGeometry(a._radius*a._maxScale),a._initialize(r,e),a._setLocalPose(),a}var n=s.prototype;return n.setRadius=function(e){this._radius=e,this._pxGeometry.radius=e*this._maxScale,this._pxShape.setGeometry(this._pxGeometry)},n.setWorldScale=function(e){o.prototype.setWorldScale.call(this,e),this._maxScale=Math.max(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),this._pxGeometry.radius=this._radius*this._maxScale,this._pxShape.setGeometry(this._pxGeometry)},s}(x),ht=function(){function o(n){n===void 0&&(n=v.Auto),this._initializeState=0,this._runTimeMode=n}var s=o.prototype;return s.initialize=function(){var t=this;if(this._initializeState===2)return Promise.resolve();if(this._initializeState===1)return this._initializePromise;var e=this._runTimeMode,i=new Promise(function(a,l){var _=document.createElement("script");if(document.body.appendChild(_),_.async=!0,_.onload=a,_.onerror=l,e==v.Auto){var c=function(){try{if(typeof WebAssembly=="object"&&typeof WebAssembly.instantiate=="function"){var u=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(A(u,WebAssembly.Module))return A(new WebAssembly.Instance(u),WebAssembly.Instance)}}catch{}return!1}();c?e=v.WebAssembly:e=v.JavaScript}e==v.JavaScript?_.src="https://mdn.alipayobjects.com/rms/afts/file/A*rnDeR58NNGoAAAAAAAAAAAAAARQnAQ/physx.release.js.js":e==v.WebAssembly&&(_.src="https://mdn.alipayobjects.com/rms/afts/file/A*nA97QLQehRMAAAAAAAAAAAAAARQnAQ/physx.release.js")}),r=new Promise(function(a,l){i.then(function(){return window.PHYSX().then(function(_){t._init(_),t._initializeState=2,t._initializePromise=null,console.log("PhysX loaded."),a()},l)},l).catch(l)});return this._initializePromise=r,r},s.destroy=function(){this._physX.PxCloseExtensions(),this._pxPhysics.release(),this._pxFoundation.release(),this._physX=null,this._pxFoundation=null,this._pxPhysics=null},s.createPhysicsManager=function(){return new tt},s.createPhysicsScene=function(t,e,i,r,a,l,_){var c=new R(this,t,e,i,r,a,l,_);return c},s.createStaticCollider=function(t,e){return new nt(this,t,e)},s.createDynamicCollider=function(t,e){return new E(this,t,e)},s.createCharacterController=function(){return new O(this)},s.createPhysicsMaterial=function(t,e,i,r,a){return new et(this,t,e,i,r,a)},s.createBoxColliderShape=function(t,e,i){return new b(this,t,e,i)},s.createSphereColliderShape=function(t,e,i){return new lt(this,t,e,i)},s.createPlaneColliderShape=function(t,e){return new at(this,t,e)},s.createCapsuleColliderShape=function(t,e,i,r){return new N(this,t,e,i,r)},s.createFixedJoint=function(t){return new st(this,t)},s.createHingeJoint=function(t){return new ot(this,t)},s.createSpringJoint=function(t){return new rt(this,t)},s._init=function(t){var e=t.PX_PHYSICS_VERSION,i=new t.PxDefaultErrorCallback,r=new t.PxDefaultAllocator,a=t.PxCreateFoundation(e,r,i),l=t.PxCreatePhysics(e,a,new t.PxTolerancesScale,!1,null);t.PxInitExtensions(l,null),this._physX=t,this._pxFoundation=a,this._pxPhysics=l},o}(),J;(function(o){o[o.Uninitialized=0]="Uninitialized",o[o.Initializing=1]="Initializing",o[o.Initialized=2]="Initialized"})(J||(J={}));var ct="1.2.0-beta.4";console.log("Galacean PhysX version: "+ct);function _t(o){const s=new y;pt(o,new h(30,0,30),new h(0,-.5,0),new y);var n=0;setInterval(()=>{n>1e3||(ut(o,new h(.075,.075,.075),new h(Math.random()-.5,Math.random()*2+2.5,Math.random()-.5),s),n++)},16)}function pt(o,s,n,t){const e=new G(o.engine);e.baseColor.set(.2179807202597362,.2939682161541871,.31177952549087606,1),e.roughness=0,e.metallic=0;const i=o.createChild(),r=i.addComponent(k);r.mesh=V.createCuboid(o.engine,s.x,s.y,s.z),r.setMaterial(e),i.transform.position=n,i.transform.rotationQuaternion=t,r.receiveShadows=!1;const a=new K;return a.position.set(0,s.y,0),i.addComponent(j).addShape(a),i}function ut(o,s,n,t){const e=new G(o.engine);e.baseColor.set(Math.random(),Math.random(),Math.random(),1),e.metallic=0,e.roughness=0;const i=o.createChild(),r=i.addComponent(k);r.mesh=V.createCuboid(o.engine,s.x,s.y,s.z),r.setMaterial(e),i.transform.position=n,i.transform.rotationQuaternion=t,r.castShadows=!1;const a=new Z;return a.size=s,i.addComponent($).addShape(a),i}U.create({canvas:"canvas",physics:new ht,graphicDeviceOptions:{powerPreference:"high-performance"}}).then(o=>{o.canvas.resizeByClientSize();const n=o.sceneManager.activeScene.createRootEntity(),t=n.createChild("camera");t.addComponent(Q),t.transform.position.set(-1,1.5,2),t.transform.lookAt(new h);const i=n.createChild("light");i.transform.setPosition(-.3,1,.4),i.transform.lookAt(new h(0,0,0));const r=i.addComponent(q);r.intensity=1,r.shadowType=Y.None,_t(n),o.run()});
